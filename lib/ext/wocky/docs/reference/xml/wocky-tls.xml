<refentry id="wocky-wocky-tls">
<refmeta>
<refentrytitle role="top_of_page" id="wocky-wocky-tls.top_of_page">Wocky TLS</refentrytitle>
<manvolnum>3</manvolnum>
<refmiscinfo>WOCKY Library</refmiscinfo>
</refmeta>

<refnamediv>
<refname>Wocky TLS</refname>
<refpurpose>Establish TLS sessions</refpurpose>
</refnamediv>

<refsynopsisdiv id="wocky-wocky-tls.synopsis" role="synopsis">
<title role="synopsis.title">Synopsis</title>
<anchor id="WockyTLSConnection"/><anchor id="WockyTLSSession"/>
<synopsis>
#define             <link linkend="WOCKY-TYPE-TLS-CONNECTION--CAPS">WOCKY_TYPE_TLS_CONNECTION</link>
#define             <link linkend="WOCKY-TYPE-TLS-SESSION--CAPS">WOCKY_TYPE_TLS_SESSION</link>
#define             <link linkend="WOCKY-TLS-SESSION--CAPS">WOCKY_TLS_SESSION</link>                   (inst)
#define             <link linkend="WOCKY-TLS-CONNECTION--CAPS">WOCKY_TLS_CONNECTION</link>                (inst)
typedef             <link linkend="WockyTLSConnection">WockyTLSConnection</link>;
typedef             <link linkend="WockyTLSSession">WockyTLSSession</link>;
<link linkend="GType">GType</link>               <link linkend="wocky-tls-connection-get-type">wocky_tls_connection_get_type</link>       (void);
<link linkend="GType">GType</link>               <link linkend="wocky-tls-session-get-type">wocky_tls_session_get_type</link>          (void);
<link linkend="WockyTLSConnection">WockyTLSConnection</link> * <link linkend="wocky-tls-session-handshake">wocky_tls_session_handshake</link>        (<link linkend="WockyTLSSession">WockyTLSSession</link> *session,
                                                         <link linkend="GCancellable">GCancellable</link> *cancellable,
                                                         <link linkend="GError">GError</link> **error);
<link linkend="void">void</link>                <link linkend="wocky-tls-session-handshake-async">wocky_tls_session_handshake_async</link>   (<link linkend="WockyTLSSession">WockyTLSSession</link> *session,
                                                         <link linkend="gint">gint</link> io_priority,
                                                         <link linkend="GCancellable">GCancellable</link> *cancellable,
                                                         <link linkend="GAsyncReadyCallback">GAsyncReadyCallback</link> callback,
                                                         <link linkend="gpointer">gpointer</link> user_data);
<link linkend="WockyTLSConnection">WockyTLSConnection</link> * <link linkend="wocky-tls-session-handshake-finish">wocky_tls_session_handshake_finish</link> (<link linkend="WockyTLSSession">WockyTLSSession</link> *session,
                                                         <link linkend="GAsyncResult">GAsyncResult</link> *result,
                                                         <link linkend="GError">GError</link> **error);
<link linkend="WockyTLSSession">WockyTLSSession</link> *   <link linkend="wocky-tls-session-new">wocky_tls_session_new</link>               (<link linkend="GIOStream">GIOStream</link> *stream);
<link linkend="WockyTLSSession">WockyTLSSession</link> *   <link linkend="wocky-tls-session-server-new">wocky_tls_session_server_new</link>        (<link linkend="GIOStream">GIOStream</link> *stream,
                                                         <link linkend="guint">guint</link> dhbits,
                                                         const <link linkend="gchar">gchar</link> *key,
                                                         const <link linkend="gchar">gchar</link> *cert);
</synopsis>
</refsynopsisdiv>

<refsect1 id="wocky-wocky-tls.object-hierarchy" role="object_hierarchy">
<title role="object_hierarchy.title">Object Hierarchy</title>
<synopsis>
  <link linkend="GObject">GObject</link>
   +----<link linkend="GIOStream">GIOStream</link>
         +----WockyTLSConnection
</synopsis>
<synopsis>
  <link linkend="GObject">GObject</link>
   +----WockyTLSSession
</synopsis>
</refsect1>





<refsect1 id="wocky-wocky-tls.properties" role="properties">
<title role="properties.title">Properties</title>
<synopsis>
  &quot;<link linkend="WockyTLSConnection--session">session</link>&quot;                  <link linkend="WockyTLSSession">WockyTLSSession</link>*      : Write / Construct Only
  &quot;<link linkend="WockyTLSSession--base-stream">base-stream</link>&quot;              <link linkend="GIOStream">GIOStream</link>*            : Write / Construct Only
  &quot;<link linkend="WockyTLSSession--dh-bits">dh-bits</link>&quot;                  <link linkend="guint">guint</link>                 : Write / Construct Only
  &quot;<link linkend="WockyTLSSession--server">server</link>&quot;                   <link linkend="gboolean">gboolean</link>              : Write / Construct Only
  &quot;<link linkend="WockyTLSSession--x509-cert">x509-cert</link>&quot;                <link linkend="gchar">gchar</link>*                : Write / Construct Only
  &quot;<link linkend="WockyTLSSession--x509-key">x509-key</link>&quot;                 <link linkend="gchar">gchar</link>*                : Write / Construct Only
</synopsis>
</refsect1>



<refsect1 id="wocky-wocky-tls.description" role="desc">
<title role="desc.title">Description</title>
<para>
The WOCKY_TLS_DEBUG_LEVEL environnement variable can be used to print debug
output from GNU TLS. To enable it, set it to a value from 1 to 9.
Higher values will print more information. See the documentation of
gnutls_global_set_log_level for more details.
</para>
<para>
Increasing the value past certain thresholds will also trigger increased
debugging output from within wocky-tls.c as well.</para>
<para>
</para>
</refsect1>

<refsect1 id="wocky-wocky-tls.details" role="details">
<title role="details.title">Details</title>
<refsect2 id="WOCKY-TYPE-TLS-CONNECTION--CAPS" role="macro">
<title>WOCKY_TYPE_TLS_CONNECTION</title>
<indexterm zone="WOCKY-TYPE-TLS-CONNECTION--CAPS"><primary sortas="WOCKY_TYPE_TLS_CONNECTION">WOCKY_TYPE_TLS_CONNECTION</primary></indexterm><programlisting>#define WOCKY_TYPE_TLS_CONNECTION (wocky_tls_connection_get_type ())
</programlisting>
<para>
</para></refsect2>
<refsect2 id="WOCKY-TYPE-TLS-SESSION--CAPS" role="macro">
<title>WOCKY_TYPE_TLS_SESSION</title>
<indexterm zone="WOCKY-TYPE-TLS-SESSION--CAPS"><primary sortas="WOCKY_TYPE_TLS_SESSION">WOCKY_TYPE_TLS_SESSION</primary></indexterm><programlisting>#define WOCKY_TYPE_TLS_SESSION    (wocky_tls_session_get_type ())
</programlisting>
<para>
</para></refsect2>
<refsect2 id="WOCKY-TLS-SESSION--CAPS" role="macro">
<title>WOCKY_TLS_SESSION()</title>
<indexterm zone="WOCKY-TLS-SESSION--CAPS"><primary sortas="WOCKY_TLS_SESSION">WOCKY_TLS_SESSION</primary></indexterm><programlisting>#define             WOCKY_TLS_SESSION(inst)</programlisting>
<para>
</para><variablelist role="params">
<varlistentry><term><parameter>inst</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="WOCKY-TLS-CONNECTION--CAPS" role="macro">
<title>WOCKY_TLS_CONNECTION()</title>
<indexterm zone="WOCKY-TLS-CONNECTION--CAPS"><primary sortas="WOCKY_TLS_CONNECTION">WOCKY_TLS_CONNECTION</primary></indexterm><programlisting>#define             WOCKY_TLS_CONNECTION(inst)</programlisting>
<para>
</para><variablelist role="params">
<varlistentry><term><parameter>inst</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="WockyTLSConnection" role="typedef">
<title>WockyTLSConnection</title>
<indexterm zone="WockyTLSConnection"><primary sortas="WockyTLSConnection">WockyTLSConnection</primary></indexterm><programlisting>typedef struct OPAQUE_TYPE__WockyTLSConnection WockyTLSConnection;
</programlisting>
<para>
</para></refsect2>
<refsect2 id="WockyTLSSession" role="typedef">
<title>WockyTLSSession</title>
<indexterm zone="WockyTLSSession"><primary sortas="WockyTLSSession">WockyTLSSession</primary></indexterm><programlisting>typedef struct OPAQUE_TYPE__WockyTLSSession WockyTLSSession;
</programlisting>
<para>
</para></refsect2>
<refsect2 id="wocky-tls-connection-get-type" role="function">
<title>wocky_tls_connection_get_type ()</title>
<indexterm zone="wocky-tls-connection-get-type"><primary sortas="wocky_tls_connection_get_type">wocky_tls_connection_get_type</primary></indexterm><programlisting><link linkend="GType">GType</link>               wocky_tls_connection_get_type       (void);</programlisting>
<para>
</para><variablelist role="params">
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="wocky-tls-session-get-type" role="function">
<title>wocky_tls_session_get_type ()</title>
<indexterm zone="wocky-tls-session-get-type"><primary sortas="wocky_tls_session_get_type">wocky_tls_session_get_type</primary></indexterm><programlisting><link linkend="GType">GType</link>               wocky_tls_session_get_type          (void);</programlisting>
<para>
</para><variablelist role="params">
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="wocky-tls-session-handshake" role="function">
<title>wocky_tls_session_handshake ()</title>
<indexterm zone="wocky-tls-session-handshake"><primary sortas="wocky_tls_session_handshake">wocky_tls_session_handshake</primary></indexterm><programlisting><link linkend="WockyTLSConnection">WockyTLSConnection</link> * wocky_tls_session_handshake        (<link linkend="WockyTLSSession">WockyTLSSession</link> *session,
                                                         <link linkend="GCancellable">GCancellable</link> *cancellable,
                                                         <link linkend="GError">GError</link> **error);</programlisting>
<para>
</para><variablelist role="params">
<varlistentry><term><parameter>session</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>cancellable</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>error</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="wocky-tls-session-handshake-async" role="function">
<title>wocky_tls_session_handshake_async ()</title>
<indexterm zone="wocky-tls-session-handshake-async"><primary sortas="wocky_tls_session_handshake_async">wocky_tls_session_handshake_async</primary></indexterm><programlisting><link linkend="void">void</link>                wocky_tls_session_handshake_async   (<link linkend="WockyTLSSession">WockyTLSSession</link> *session,
                                                         <link linkend="gint">gint</link> io_priority,
                                                         <link linkend="GCancellable">GCancellable</link> *cancellable,
                                                         <link linkend="GAsyncReadyCallback">GAsyncReadyCallback</link> callback,
                                                         <link linkend="gpointer">gpointer</link> user_data);</programlisting>
<para>
</para><variablelist role="params">
<varlistentry><term><parameter>session</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>io_priority</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>cancellable</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>callback</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>user_data</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="wocky-tls-session-handshake-finish" role="function">
<title>wocky_tls_session_handshake_finish ()</title>
<indexterm zone="wocky-tls-session-handshake-finish"><primary sortas="wocky_tls_session_handshake_finish">wocky_tls_session_handshake_finish</primary></indexterm><programlisting><link linkend="WockyTLSConnection">WockyTLSConnection</link> * wocky_tls_session_handshake_finish (<link linkend="WockyTLSSession">WockyTLSSession</link> *session,
                                                         <link linkend="GAsyncResult">GAsyncResult</link> *result,
                                                         <link linkend="GError">GError</link> **error);</programlisting>
<para>
</para><variablelist role="params">
<varlistentry><term><parameter>session</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>result</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>error</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="wocky-tls-session-new" role="function">
<title>wocky_tls_session_new ()</title>
<indexterm zone="wocky-tls-session-new"><primary sortas="wocky_tls_session_new">wocky_tls_session_new</primary></indexterm><programlisting><link linkend="WockyTLSSession">WockyTLSSession</link> *   wocky_tls_session_new               (<link linkend="GIOStream">GIOStream</link> *stream);</programlisting>
<para>
</para><variablelist role="params">
<varlistentry><term><parameter>stream</parameter>&#160;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="wocky-tls-session-server-new" role="function">
<title>wocky_tls_session_server_new ()</title>
<indexterm zone="wocky-tls-session-server-new"><primary sortas="wocky_tls_session_server_new">wocky_tls_session_server_new</primary></indexterm><programlisting><link linkend="WockyTLSSession">WockyTLSSession</link> *   wocky_tls_session_server_new        (<link linkend="GIOStream">GIOStream</link> *stream,
                                                         <link linkend="guint">guint</link> dhbits,
                                                         const <link linkend="gchar">gchar</link> *key,
                                                         const <link linkend="gchar">gchar</link> *cert);</programlisting>
<para>
Create a new TLS server session</para>
<para>
</para><variablelist role="params">
<varlistentry><term><parameter>stream</parameter>&#160;:</term>
<listitem><simpara> a GIOStream on which we expect to receive the client TLS handshake
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>dhbits</parameter>&#160;:</term>
<listitem><simpara> size of the DH parameters (see gnutls for valid settings)
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara> the path to the X509 PEM key file
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara> the path to the X509 PEM certificate
</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara> a <link linkend="WockyTLSSession"><type>WockyTLSSession</type></link> object
</simpara></listitem></varlistentry>
</variablelist></refsect2>

</refsect1>
<refsect1 id="wocky-wocky-tls.property-details" role="property_details">
<title role="property_details.title">Property Details</title>
<refsect2 id="WockyTLSConnection--session" role="property"><title>The <literal>&quot;session&quot;</literal> property</title>
<indexterm zone="WockyTLSConnection--session"><primary sortas="WockyTLSConnection:session">WockyTLSConnection:session</primary></indexterm><programlisting>  &quot;session&quot;                  <link linkend="WockyTLSSession">WockyTLSSession</link>*      : Write / Construct Only</programlisting>
<para>the TLS session object for this connection.</para></refsect2>
<refsect2 id="WockyTLSSession--base-stream" role="property"><title>The <literal>&quot;base-stream&quot;</literal> property</title>
<indexterm zone="WockyTLSSession--base-stream"><primary sortas="WockyTLSSession:base-stream">WockyTLSSession:base-stream</primary></indexterm><programlisting>  &quot;base-stream&quot;              <link linkend="GIOStream">GIOStream</link>*            : Write / Construct Only</programlisting>
<para>the stream that TLS communicates over.</para></refsect2>
<refsect2 id="WockyTLSSession--dh-bits" role="property"><title>The <literal>&quot;dh-bits&quot;</literal> property</title>
<indexterm zone="WockyTLSSession--dh-bits"><primary sortas="WockyTLSSession:dh-bits">WockyTLSSession:dh-bits</primary></indexterm><programlisting>  &quot;dh-bits&quot;                  <link linkend="guint">guint</link>                 : Write / Construct Only</programlisting>
<para>Diffie-Hellmann bits: 768, 1024, 2048, 3072 0r 4096.</para><para>Allowed values: [768,4096]</para>
<para>Default value: 1024</para>
</refsect2>
<refsect2 id="WockyTLSSession--server" role="property"><title>The <literal>&quot;server&quot;</literal> property</title>
<indexterm zone="WockyTLSSession--server"><primary sortas="WockyTLSSession:server">WockyTLSSession:server</primary></indexterm><programlisting>  &quot;server&quot;                   <link linkend="gboolean">gboolean</link>              : Write / Construct Only</programlisting>
<para>whether this is a server.</para><para>Default value: FALSE</para>
</refsect2>
<refsect2 id="WockyTLSSession--x509-cert" role="property"><title>The <literal>&quot;x509-cert&quot;</literal> property</title>
<indexterm zone="WockyTLSSession--x509-cert"><primary sortas="WockyTLSSession:x509-cert">WockyTLSSession:x509-cert</primary></indexterm><programlisting>  &quot;x509-cert&quot;                <link linkend="gchar">gchar</link>*                : Write / Construct Only</programlisting>
<para>x509 PEM certificate file.</para><para>Default value: NULL</para>
</refsect2>
<refsect2 id="WockyTLSSession--x509-key" role="property"><title>The <literal>&quot;x509-key&quot;</literal> property</title>
<indexterm zone="WockyTLSSession--x509-key"><primary sortas="WockyTLSSession:x509-key">WockyTLSSession:x509-key</primary></indexterm><programlisting>  &quot;x509-key&quot;                 <link linkend="gchar">gchar</link>*                : Write / Construct Only</programlisting>
<para>x509 PEM key file.</para><para>Default value: NULL</para>
</refsect2>
</refsect1>




</refentry>
